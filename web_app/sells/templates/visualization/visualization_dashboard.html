{% extends 'base/page/base.html' %}
{% load static %}

{% block title %}
<title>CRM аналитика</title>
{% endblock title %}

{%block styles %}
<link rel="stylesheet" href="{% static 'sells/css/sells.css' %}">
<link rel="stylesheet" href="{% static 'sells/css/graphics.css' %}">
{% endblock styles%}


{% block sidebar %}

{% include 'base/page/sidebar.html' with crm="active" %}

{% endblock sidebar %}


{% block navbar %}

{% include 'base/page/navbar.html' %}

{% endblock navbar %}

{% block pagecontent %}


<div class="container-fluid main-page mt-5">
    <div class="row">
        <div class="col-3 col-sm-3 col-md-3 col-lg-3 col-xxl-3 crm-menu">
            {% include 'base/sells/left_navigation.html' with visualization="item-active" %}
        </div>
        <div class="col-9 col-md-9 col-lg-9 col-xxl-9">
            <div class="d-sm-flex justify-content-between align-items-center mb-4">
                <h4 class="mb-2">Показатели продаж</h4>
            </div>



            <script src="https://code.highcharts.com/highcharts.js"></script>
            <script src="https://code.highcharts.com/modules/data.js"></script>
            <script src="https://code.highcharts.com/modules/drilldown.js"></script>
            <script src="https://code.highcharts.com/modules/exporting.js"></script>
            <script src="https://code.highcharts.com/modules/export-data.js"></script>
            <script src="https://code.highcharts.com/modules/accessibility.js"></script>
            <script src="https://code.highcharts.com/modules/series-label.js"></script>
            <div class="row">
                <div class="col-12 col-md-12 col-lg-6 col-xxl-6">
                    <div class="widget card shadow mb-4">
                        <div class="card-header widget py-3">
                                <figure class="highcharts-figure">
                                    <div id="container"></div>
                                </figure>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-12 col-lg-6 col-xxl-6">
                    <div class="widget card shadow mb-4">
                        <div class="card-header widget py-3">
                            <figure class="highcharts-figure">
                            <div id="container2"></div>
                            </figure>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-12 col-lg-6 col-xxl-6">
                    <div class="widget card shadow mb-4">
                        <div class="card-header widget py-3">
                                <figure class="highcharts-figure">
                                    <div id="container4"></div>
                                </figure>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-12 col-lg-6 col-xxl-6">
                    <div class="widget card shadow mb-4">
                        <div class="card-header widget py-3">
                            <figure class="highcharts-figure">
                                <div id="container3"></div>
                            </figure>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>








            <script>
                // Data retrieved from https://netmarketshare.com/
            // Build the chart
                var data = {{categories_max|safe}}

            Highcharts.chart('container', {
                chart: {
                    type: 'column'
                },
                title: {
                    align: 'left',
                    text: 'График продаж по категориям товаров'
                },
                subtitle: {
                    align: 'left',

                },
                accessibility: {
                    announceNewData: {
                        enabled: true
                    }
                },
                xAxis: {
                    type: 'category'
                },
                yAxis: {
                    title: {
                        text: 'Общая сумма продаж'
                    }

                },
                legend: {
                    enabled: false
                },
                plotOptions: {
                    series: {
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            format: '{point.y:.1f} руб'
                        }
                    }
                },

                tooltip: {
                    headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
                    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}</b> of total<br/>'
                },

                series: [
                    {
                        name: 'Browsers',
                        colorByPoint: true,
                        data: data
                    }
                ],
                drilldown: {
                    breadcrumbs: {
                        position: {
                            align: 'right'
                        }
                    },
                    series: [
                        {
                            name: 'Chrome',
                            id: 'Chrome',
                            data: [
                                [
                                    'v65.0',
                                    0.1
                                ],
                                [
                                    'v64.0',
                                    1.3
                                ],
                                [
                                    'v63.0',
                                    53.02
                                ],
                                [
                                    'v62.0',
                                    1.4
                                ],
                                [
                                    'v61.0',
                                    0.88
                                ],
                                [
                                    'v60.0',
                                    0.56
                                ],
                                [
                                    'v59.0',
                                    0.45
                                ],
                                [
                                    'v58.0',
                                    0.49
                                ],
                                [
                                    'v57.0',
                                    0.32
                                ],
                                [
                                    'v56.0',
                                    0.29
                                ],
                                [
                                    'v55.0',
                                    0.79
                                ],
                                [
                                    'v54.0',
                                    0.18
                                ],
                                [
                                    'v51.0',
                                    0.13
                                ],
                                [
                                    'v49.0',
                                    2.16
                                ],
                                [
                                    'v48.0',
                                    0.13
                                ],
                                [
                                    'v47.0',
                                    0.11
                                ],
                                [
                                    'v43.0',
                                    0.17
                                ],
                                [
                                    'v29.0',
                                    0.26
                                ]
                            ]
                        },
                        {
                            name: 'Firefox',
                            id: 'Firefox',
                            data: [
                                [
                                    'v58.0',
                                    1.02
                                ],
                                [
                                    'v57.0',
                                    7.36
                                ],
                                [
                                    'v56.0',
                                    0.35
                                ],
                                [
                                    'v55.0',
                                    0.11
                                ],
                                [
                                    'v54.0',
                                    0.1
                                ],
                                [
                                    'v52.0',
                                    0.95
                                ],
                                [
                                    'v51.0',
                                    0.15
                                ],
                                [
                                    'v50.0',
                                    0.1
                                ],
                                [
                                    'v48.0',
                                    0.31
                                ],
                                [
                                    'v47.0',
                                    0.12
                                ]
                            ]
                        },
                        {
                            name: 'Internet Explorer',
                            id: 'Internet Explorer',
                            data: [
                                [
                                    'v11.0',
                                    6.2
                                ],
                                [
                                    'v10.0',
                                    0.29
                                ],
                                [
                                    'v9.0',
                                    0.27
                                ],
                                [
                                    'v8.0',
                                    0.47
                                ]
                            ]
                        },
                        {
                            name: 'Safari',
                            id: 'Safari',
                            data: [
                                [
                                    'v11.0',
                                    3.39
                                ],
                                [
                                    'v10.1',
                                    0.96
                                ],
                                [
                                    'v10.0',
                                    0.36
                                ],
                                [
                                    'v9.1',
                                    0.54
                                ],
                                [
                                    'v9.0',
                                    0.13
                                ],
                                [
                                    'v5.1',
                                    0.2
                                ]
                            ]
                        },
                        {
                            name: 'Edge',
                            id: 'Edge',
                            data: [
                                [
                                    'v16',
                                    2.6
                                ],
                                [
                                    'v15',
                                    0.92
                                ],
                                [
                                    'v14',
                                    0.4
                                ],
                                [
                                    'v13',
                                    0.1
                                ]
                            ]
                        },
                        {
                            name: 'Opera',
                            id: 'Opera',
                            data: [
                                [
                                    'v50.0',
                                    0.96
                                ],
                                [
                                    'v49.0',
                                    0.82
                                ],
                                [
                                    'v12.1',
                                    0.14
                                ]
                            ]
                        }
                    ]
                }
            });
            </script>

            <script>
                var data_2 = {{by_name_max|safe}}
                Highcharts.chart('container2', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: 'Диграмма продаж отдельно взятых товаров',
                    align: 'left'
                },
                tooltip: {
                    pointFormat: 'Процент от общего: <b>{point.percentage:.1f}%</b>'
                },
                accessibility: {
                    point: {
                        valueSuffix: '%'
                    }
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: false
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Brands',
                    colorByPoint: true,
                    data: data_2
                }]
            });


            </script>

            <script>
                var data_3 = {{sort_by_order|safe}}
            Highcharts.chart('container3', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: 0,
                    plotShadow: false
                },
                title: {
                    text: 'Статусы<br>оплаты<br>',
                    align: 'center',
                    verticalAlign: 'middle',
                    y: 60
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                accessibility: {
                    point: {
                        valueSuffix: '%'
                    }
                },
                plotOptions: {
                    pie: {
                        dataLabels: {
                            enabled: true,
                            distance: -50,
                            style: {
                                fontWeight: 'bold',
                                color: 'white'
                            }
                        },
                        startAngle: -90,
                        endAngle: 90,
                        center: ['50%', '75%'],
                        size: '110%'
                    }
                },
                series: [{
                    type: 'pie',
                    name: 'Browser share',
                    innerSize: '50%',
                    data: data_3
                }]
            });
            </script>

            <script>
                // Data retrieved from https://netmarketshare.com/
            // Build the chart
                var data_4 = {{sort_by_amount|safe}};

            Highcharts.chart('container4', {
                chart: {
                    type: 'column'
                },
                title: {
                    align: 'left',
                    text: 'График количества проданных единиц'
                },
                subtitle: {
                    align: 'left',

                },
                accessibility: {
                    announceNewData: {
                        enabled: true
                    }
                },
                xAxis: {
                    type: 'category'
                },
                yAxis: {
                    title: {
                        text: 'Количество'
                    }

                },
                legend: {
                    enabled: false
                },
                plotOptions: {
                    series: {
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            format: '{point.y:.1f} шт'
                        }
                    }
                },

                tooltip: {
                    headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
                    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}</b> шт.<br/>'
                },

                series: [
                    {
                        name: 'Browsers',
                        colorByPoint: true,
                        data: data_4
                    }
                ],
                drilldown: {
                    breadcrumbs: {
                        position: {
                            align: 'right'
                        }
                    },
                    series: [
                        {
                            name: 'Chrome',
                            id: 'Chrome',
                            data: [
                                [
                                    'v65.0',
                                    0.1
                                ],
                                [
                                    'v64.0',
                                    1.3
                                ],
                                [
                                    'v63.0',
                                    53.02
                                ],
                                [
                                    'v62.0',
                                    1.4
                                ],
                                [
                                    'v61.0',
                                    0.88
                                ],
                                [
                                    'v60.0',
                                    0.56
                                ],
                                [
                                    'v59.0',
                                    0.45
                                ],
                                [
                                    'v58.0',
                                    0.49
                                ],
                                [
                                    'v57.0',
                                    0.32
                                ],
                                [
                                    'v56.0',
                                    0.29
                                ],
                                [
                                    'v55.0',
                                    0.79
                                ],
                                [
                                    'v54.0',
                                    0.18
                                ],
                                [
                                    'v51.0',
                                    0.13
                                ],
                                [
                                    'v49.0',
                                    2.16
                                ],
                                [
                                    'v48.0',
                                    0.13
                                ],
                                [
                                    'v47.0',
                                    0.11
                                ],
                                [
                                    'v43.0',
                                    0.17
                                ],
                                [
                                    'v29.0',
                                    0.26
                                ]
                            ]
                        },
                        {
                            name: 'Firefox',
                            id: 'Firefox',
                            data: [
                                [
                                    'v58.0',
                                    1.02
                                ],
                                [
                                    'v57.0',
                                    7.36
                                ],
                                [
                                    'v56.0',
                                    0.35
                                ],
                                [
                                    'v55.0',
                                    0.11
                                ],
                                [
                                    'v54.0',
                                    0.1
                                ],
                                [
                                    'v52.0',
                                    0.95
                                ],
                                [
                                    'v51.0',
                                    0.15
                                ],
                                [
                                    'v50.0',
                                    0.1
                                ],
                                [
                                    'v48.0',
                                    0.31
                                ],
                                [
                                    'v47.0',
                                    0.12
                                ]
                            ]
                        },
                        {
                            name: 'Internet Explorer',
                            id: 'Internet Explorer',
                            data: [
                                [
                                    'v11.0',
                                    6.2
                                ],
                                [
                                    'v10.0',
                                    0.29
                                ],
                                [
                                    'v9.0',
                                    0.27
                                ],
                                [
                                    'v8.0',
                                    0.47
                                ]
                            ]
                        },
                        {
                            name: 'Safari',
                            id: 'Safari',
                            data: [
                                [
                                    'v11.0',
                                    3.39
                                ],
                                [
                                    'v10.1',
                                    0.96
                                ],
                                [
                                    'v10.0',
                                    0.36
                                ],
                                [
                                    'v9.1',
                                    0.54
                                ],
                                [
                                    'v9.0',
                                    0.13
                                ],
                                [
                                    'v5.1',
                                    0.2
                                ]
                            ]
                        },
                        {
                            name: 'Edge',
                            id: 'Edge',
                            data: [
                                [
                                    'v16',
                                    2.6
                                ],
                                [
                                    'v15',
                                    0.92
                                ],
                                [
                                    'v14',
                                    0.4
                                ],
                                [
                                    'v13',
                                    0.1
                                ]
                            ]
                        },
                        {
                            name: 'Opera',
                            id: 'Opera',
                            data: [
                                [
                                    'v50.0',
                                    0.96
                                ],
                                [
                                    'v49.0',
                                    0.82
                                ],
                                [
                                    'v12.1',
                                    0.14
                                ]
                            ]
                        }
                    ]
                }
            });
            </script>
{% include 'base/page/chatbot.html' %}
{% endblock pagecontent %}

{% block scripts %}

{% endblock scripts %}